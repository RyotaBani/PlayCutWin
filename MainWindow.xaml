<Window x:Class="PlayCutWin.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PlayCutWin"
        mc:Ignorable="d"
        Title="Play Cut"
        Width="1400" Height="860"
        MinWidth="1200" MinHeight="740"
        Background="#121212"
        Foreground="#EAEAEA"
        WindowStartupLocation="CenterScreen"><Grid x:Name="RootGrid" Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="3*"/>
            <RowDefinition Height="2*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
                <!-- Mac版に近い見え方：左右をほぼ 1:1 にして右側（Clips/ボタン）が切れないようにする -->
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- =======================
             Top-Left: VIDEO
             ======================= -->
        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource Panel}" Margin="0,0,10,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <DockPanel Margin="0,0,0,10">
                    <TextBlock Text="Video (16:9)" FontSize="16" FontWeight="SemiBold" DockPanel.Dock="Left"/>

                    <!-- Mac-like (no pill): simple labels when team names are empty or set -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center" Opacity="0.9">
                        <TextBlock Text="Team A" Opacity="0.7" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding TeamAName}" Margin="0,0,14,0" Opacity="0.95"/>
                        <TextBlock Text="Team B" Opacity="0.7" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding TeamBName}" Opacity="0.95"/>
                    </StackPanel>
                </DockPanel>

                <Border Grid.Row="1" Background="#0F0F0F" CornerRadius="10" BorderBrush="#2A2A2A" BorderThickness="1">
                    <Grid>
                        <!-- Hint (コードビハインドから参照されるので必ず存在させる) -->
                        <TextBlock x:Name="VideoHint"
                                   Text="Load video from the button →"
                                   Foreground="#8A8A8A"
                                   FontSize="14"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>

                        <!-- Player -->
                        <MediaElement x:Name="Player"
                                      LoadedBehavior="Manual"
                                      UnloadedBehavior="Manual"
                                      Stretch="Uniform"
                                      MediaOpened="Player_MediaOpened"
                                      MediaFailed="Player_MediaFailed"
                                      />
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- =======================
             Top-Right: CLIPS / BUTTONS
             ======================= -->
        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource Panel}" Margin="10,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Top bar -->
                <DockPanel Grid.Row="0" Margin="0,0,0,10">
                    <ComboBox x:Name="ClipFilterComboBox"
                              Width="160"
                              VerticalContentAlignment="Center"
                              Style="{StaticResource ComboBoxMacLike}"
                              DockPanel.Dock="Left"
                              SelectionChanged="ClipFilterComboBox_SelectionChanged">
                        <ComboBoxItem Content="All Clips"/>
                        <ComboBoxItem Content="Team A Clips"/>
                        <ComboBoxItem Content="Team B Clips"/>
                    </ComboBox>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                        <Button Content="Delete" Style="{StaticResource SecondaryButton}" Margin="0,0,8,0" Click="DeleteSelectedClip_Click"/>
                        <Button Content="Import CSV" Style="{StaticResource SecondaryButton}" Margin="0,0,8,0" Click="ImportCsv_Click"/>
                        <Button Content="Export CSV" Style="{StaticResource SecondaryButton}" Margin="0,0,8,0" Click="ExportCsv_Click"/>
                        <Button Content="Export All" Style="{StaticResource SecondaryButton}" Margin="0,0,8,0" Click="ExportAll_Click"/>
                        <Button Content="Load Video" Style="{StaticResource PrimaryButton}" Click="LoadVideo_Click"/>
                    </StackPanel>
                </DockPanel>

                <!-- Loaded video name -->
                <TextBlock Grid.Row="1"
                           x:Name="LoadedVideoNameText"
                           Text=""
                           Foreground="#B9B9B9"
                           TextTrimming="CharacterEllipsis"
                           Margin="0,0,0,10"/>

                <!-- Clips grids -->
                <Grid Grid.Row="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Clips" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,6"/>

                    <Grid Grid.Row="1" ColumnDefinitions="*,*" ColumnSpacing="10">
                        <!-- Team A -->
                        <Border Style="{StaticResource InnerPanel}" Margin="0,0,5,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="Team A Clips" FontWeight="SemiBold" Margin="0,0,0,6"/>

                                <!-- Empty message (mac-like) -->
                                <TextBlock x:Name="TeamAEmptyText"
                                           Text="No clips for Team A with current filter."
                                           Foreground="#8A8A8A"
                                           Visibility="Collapsed"
                                           Margin="0,4,0,0"/>

                                <DataGrid x:Name="TeamAClipList"
                                          Grid.Row="1"
                                          AutoGenerateColumns="False"
                                          HeadersVisibility="Column"
                                          SelectionMode="Single"
                                          IsReadOnly="True"
                                          Style="{StaticResource DataGridMacLike}"
                                          SelectionChanged="ClipList_SelectionChanged"
                                          PreviewMouseDoubleClick="ClipList_PreviewMouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Team" Binding="{Binding TeamShort}" Width="60"/>
                                        <DataGridTextColumn Header="Start" Binding="{Binding StartText}" Width="80"/>
                                        <DataGridTextColumn Header="End" Binding="{Binding EndText}" Width="80"/>
                                        <DataGridTextColumn Header="Tags" Binding="{Binding TagsText}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Border>

                        <!-- Team B -->
                        <Border Grid.Column="1" Style="{StaticResource InnerPanel}" Margin="5,0,0,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="Team B Clips" FontWeight="SemiBold" Margin="0,0,0,6"/>

                                <!-- Empty message (mac-like) -->
                                <TextBlock x:Name="TeamBEmptyText"
                                           Text="No clips for Team B with current filter."
                                           Foreground="#8A8A8A"
                                           Visibility="Collapsed"
                                           Margin="0,4,0,0"/>

                                <DataGrid x:Name="TeamBClipList"
                                          Grid.Row="1"
                                          AutoGenerateColumns="False"
                                          HeadersVisibility="Column"
                                          SelectionMode="Single"
                                          IsReadOnly="True"
                                          Style="{StaticResource DataGridMacLike}"
                                          SelectionChanged="ClipList_SelectionChanged"
                                          PreviewMouseDoubleClick="ClipList_PreviewMouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Team" Binding="{Binding TeamShort}" Width="60"/>
                                        <DataGridTextColumn Header="Start" Binding="{Binding StartText}" Width="80"/>
                                        <DataGridTextColumn Header="End" Binding="{Binding EndText}" Width="80"/>
                                        <DataGridTextColumn Header="Tags" Binding="{Binding TagsText}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>

                <!-- Clip Note -->
                <StackPanel Grid.Row="3" Margin="0,10,0,0">
                    <TextBlock Text="Clip Note" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,6"/>
                    <TextBox x:Name="ClipNoteTextBox"
                             Height="70"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             Style="{StaticResource TextBoxMacLike}"
                             TextChanged="ClipNoteTextBox_TextChanged"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- =======================
             Bottom-Left: CONTROLS
             ======================= -->
        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource Panel}" Margin="0,10,10,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Controls" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,10"/>

                <StackPanel Grid.Row="1" Spacing="10">
                    <TextBlock Text="Load a video to show the timeline slider here." Foreground="#8A8A8A"/>

                    <Slider x:Name="TimelineSlider"
                            Minimum="0"
                            Maximum="1"
                            Value="0"
                            Margin="0,6,0,0"
                            PreviewMouseDown="TimelineSlider_PreviewMouseDown"
                            PreviewMouseUp="TimelineSlider_PreviewMouseUp"
                            ValueChanged="TimelineSlider_ValueChanged"/>

                    <TextBlock x:Name="PlaybackInfoText" Text="Playback Speed" Foreground="#B9B9B9"/>

                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Content="0.25x" Style="{StaticResource SecondaryButtonSmall}" Click="Speed025_Click"/>
                        <Button Content="0.5x" Style="{StaticResource SecondaryButtonSmall}" Click="Speed05_Click"/>
                        <Button Content="1x" Style="{StaticResource SecondaryButtonSmall}" Click="Speed1_Click"/>
                        <Button Content="2x" Style="{StaticResource SecondaryButtonSmall}" Click="Speed2_Click"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Content="-5s" Style="{StaticResource SecondaryButtonSmall}" Click="Back5_Click"/>
                        <Button Content="-1s" Style="{StaticResource SecondaryButtonSmall}" Click="Back1_Click"/>
                        <Button x:Name="PlayPauseButton" Content="Play" Style="{StaticResource PrimaryButtonSmall}" Click="PlayPause_Click"/>
                        <Button Content="+1s" Style="{StaticResource SecondaryButtonSmall}" Click="Forward1_Click"/>
                        <Button Content="+5s" Style="{StaticResource SecondaryButtonSmall}" Click="Forward5_Click"/>
                    </StackPanel>

                    <TextBlock Text="Clip Range" FontWeight="SemiBold" Margin="0,8,0,0"/>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Content="Clip START" Style="{StaticResource SecondaryButton}" Click="SetClipStart_Click"/>
                        <Button Grid.Column="1" Content="Clip END" Style="{StaticResource SecondaryButton}" Click="SetClipEnd_Click"/>
                    </Grid>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Content="Save Team A" Style="{StaticResource SecondaryButton}" Click="SaveTeamA_Click"/>
                        <Button Grid.Column="1" Content="Save Team B" Style="{StaticResource SecondaryButton}" Click="SaveTeamB_Click"/>
                    </Grid>

                    <TextBlock x:Name="CsvStatusText" Text="" Foreground="#B9B9B9"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- =======================
             Bottom-Right: TAGS
             ======================= -->
        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource Panel}" Margin="10,10,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <DockPanel Margin="0,0,0,10">
                    <TextBlock Text="Tags" FontSize="14" FontWeight="SemiBold" DockPanel.Dock="Left"/>
                    <Button Content="Preferences..." Style="{StaticResource GhostButton}" DockPanel.Dock="Right" Click="Preferences_Click"/>
                </DockPanel>

                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Offense Tags" Foreground="#B9B9B9"/>

                        <ItemsControl ItemsSource="{Binding OffenseTags}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <ToggleButton Content="{Binding Name}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Style="{StaticResource TagToggleButtonRed}"
                                                  Margin="0,0,8,8"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="Defense Tags" Foreground="#B9B9B9"/>

                        <ItemsControl ItemsSource="{Binding DefenseTags}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <ToggleButton Content="{Binding Name}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Style="{StaticResource TagToggleButtonBlue}"
                                                  Margin="0,0,8,8"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="Custom Tag" Foreground="#B9B9B9"/>

                        <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                            <TextBox x:Name="CustomTagTextBox" Grid.Column="0" Style="{StaticResource TextBoxMacLike}" Height="30" VerticalContentAlignment="Center"/>
                            <Button Grid.Column="1" Content="Add" Style="{StaticResource SecondaryButton}" Click="AddCustomTag_Click"/>
                            <Button Grid.Column="2" Content="Clear" Style="{StaticResource SecondaryButton}" Click="ClearTags_Click"/>
                        </Grid>

                        <TextBlock Text="Current Tags" Foreground="#B9B9B9"/>
                        <TextBlock x:Name="CurrentTagsText" Text="" Foreground="#EAEAEA"/>

                        <!-- Tag Note section (kept) -->
                        <TextBlock Text="Tag Note" Foreground="#B9B9B9"/>
                        <TextBlock x:Name="TagNoteHintText" Text="(No tag selected)" Foreground="#8A8A8A"/>

                        <!-- Empty message for Video -->
                        <TextBlock x:Name="NoVideoLoadedText"
                                   Text="No video loaded"
                                   Foreground="#8A8A8A"
                                   Visibility="Collapsed"
                                   Margin="0,10,0,0"/>

                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid></Window>
