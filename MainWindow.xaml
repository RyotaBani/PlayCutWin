<Window x:Class="PlayCutWin.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:helpers="clr-namespace:PlayCutWin.Helpers"
        mc:Ignorable="d"
        Title="Play Cut"
        Width="1200" Height="720"
        Background="#111">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="12" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="12" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- =========================
             Top-Left : Video
        ========================== -->
        <Border Grid.Row="0" Grid.Column="0" CornerRadius="12" Background="#1B1B1B" Padding="12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <DockPanel Grid.Row="0">
                    <TextBlock Text="Video (16:9)"
                               Foreground="#EAEAEA"
                               FontSize="16"
                               FontWeight="SemiBold"
                               DockPanel.Dock="Left"/>

                    <Button Content="Load Video"
                            DockPanel.Dock="Right"
                            Padding="14,6"
                            Margin="8,0,0,0"
                            Command="{Binding LoadVideoCommand}"/>
                </DockPanel>

                <Grid Grid.Row="0" Margin="0,28,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="12" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Team A" Foreground="#BFBFBF" FontSize="12" />
                        <TextBox Text="{Binding TeamAName, UpdateSourceTrigger=PropertyChanged}"
                                 Height="28"
                                 Margin="0,4,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Team B" Foreground="#BFBFBF" FontSize="12" />
                        <TextBox Text="{Binding TeamBName, UpdateSourceTrigger=PropertyChanged}"
                                 Height="28"
                                 Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>

                <!-- Video surface (placeholder) -->
                <Border Grid.Row="2"
                        CornerRadius="10"
                        Background="#101010"
                        BorderBrush="#2A2A2A"
                        BorderThickness="1">
                    <Grid>
                        <!-- 実際の再生UIはあなたの MediaElement/PlayerControl をここに置く想定 -->
                        <TextBlock Text="Load video from the button →"
                                   Foreground="#8A8A8A"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   FontSize="16"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- =========================
             Top-Right : Clips
        ========================== -->
        <Border Grid.Row="0" Grid.Column="2" CornerRadius="12" Background="#1B1B1B" Padding="12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DockPanel Grid.Row="0">
                    <TextBlock Text="Clips (Total 0)"
                               Foreground="#EAEAEA"
                               FontSize="16"
                               FontWeight="SemiBold"
                               DockPanel.Dock="Left"/>

                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                        <ComboBox Width="140"
                                  SelectedItem="{Binding SelectedClipFilter}"
                                  ItemsSource="{Binding ClipFilters}"
                                  Margin="0,0,8,0"/>
                        <Button Content="Import CSV" Margin="0,0,6,0" Command="{Binding ImportCsvCommand}"/>
                        <Button Content="Export CSV" Margin="0,0,6,0" Command="{Binding ExportCsvCommand}"/>
                        <Button Content="Export All" Command="{Binding ExportAllCommand}"/>
                    </StackPanel>
                </DockPanel>

                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Team A Clips (0)" Foreground="#BFBFBF" FontSize="12"/>
                        <ListBox ItemsSource="{Binding TeamAClips}" Margin="0,6,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Team B Clips (0)" Foreground="#BFBFBF" FontSize="12"/>
                        <ListBox ItemsSource="{Binding TeamBClips}" Margin="0,6,0,0"/>
                    </StackPanel>
                </Grid>

                <TextBlock Grid.Row="3"
                           Text="{Binding TagStatsText, FallbackValue=Tag Stats: No clips yet.}"
                           Foreground="#8A8A8A"
                           Margin="0,10,0,0"/>
            </Grid>
        </Border>

        <!-- =========================
             Bottom-Left : Controls
        ========================== -->
        <Border Grid.Row="2" Grid.Column="0" CornerRadius="12" Background="#1B1B1B" Padding="12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Controls" Foreground="#EAEAEA" FontSize="16" FontWeight="SemiBold"/>

                <TextBlock Grid.Row="2" Text="Playback Speed" Foreground="#BFBFBF" FontSize="12"/>
                <UniformGrid Grid.Row="4" Rows="1" Columns="4" Margin="0,6,0,0">
                    <Button Content="0.25x" Command="{Binding SetSpeedCommand}" CommandParameter="0.25"/>
                    <Button Content="0.5x"  Command="{Binding SetSpeedCommand}" CommandParameter="0.5"/>
                    <Button Content="1x"    Command="{Binding SetSpeedCommand}" CommandParameter="1.0"/>
                    <Button Content="2x"    Command="{Binding SetSpeedCommand}" CommandParameter="2.0"/>
                </UniformGrid>

                <UniformGrid Grid.Row="6" Rows="1" Columns="5">
                    <Button Content="-5s" Command="{Binding SeekCommand}" CommandParameter="-5"/>
                    <Button Content="-1s" Command="{Binding SeekCommand}" CommandParameter="-1"/>
                    <Button Content="Play" Command="{Binding TogglePlayCommand}"/>
                    <Button Content="+1s" Command="{Binding SeekCommand}" CommandParameter="1"/>
                    <Button Content="+5s" Command="{Binding SeekCommand}" CommandParameter="5"/>
                </UniformGrid>

                <TextBlock Grid.Row="8" Text="Clip Range" Foreground="#BFBFBF" FontSize="12"/>

                <Grid Grid.Row="9" Margin="0,6,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Content="Clip START" Padding="14,6"
                            Command="{Binding MarkClipStartCommand}"/>
                    <Button Grid.Column="2" Content="Clip END" Padding="14,6"
                            Command="{Binding MarkClipEndCommand}"/>

                    <!-- ★ BooleanBox を使う箇所（ここが今落ちてた） -->
                    <Button Grid.Column="4" Content="Save Team A" Padding="14,6"
                            Command="{Binding SaveClipCommand}"
                            CommandParameter="{helpers:BooleanBox True}"/>
                    <Button Grid.Column="6" Content="Save Team B" Padding="14,6"
                            Command="{Binding SaveClipCommand}"
                            CommandParameter="{helpers:BooleanBox False}"/>

                    <TextBlock Grid.Column="7"
                               Text="{Binding StatusText, FallbackValue=Ready}"
                               Foreground="#8A8A8A"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Center"/>
                </Grid>
            </Grid>
        </Border>

        <!-- =========================
             Bottom-Right : Tags
        ========================== -->
        <Border Grid.Row="2" Grid.Column="2" CornerRadius="12" Background="#1B1B1B" Padding="12">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="10"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <DockPanel>
                    <TextBlock Text="Tags" Foreground="#EAEAEA" FontSize="16" FontWeight="SemiBold"/>
                    <Button Content="Preferences..."
                            DockPanel.Dock="Right"
                            Command="{Binding OpenPreferencesCommand}"/>
                </DockPanel>

                <TextBlock Grid.Row="2" Text="Offense Tags" Foreground="#BFBFBF" FontSize="12"/>
                <ItemsControl Grid.Row="4" ItemsSource="{Binding OffenseTags}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="3"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ToggleButton Content="{Binding}"
                                          Margin="4"
                                          Command="{Binding DataContext.ToggleTagCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                          CommandParameter="{Binding}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <TextBlock Grid.Row="6" Text="Defense Tags" Foreground="#BFBFBF" FontSize="12"/>
                <ItemsControl Grid.Row="8" ItemsSource="{Binding DefenseTags}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <UniformGrid Columns="3"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ToggleButton Content="{Binding}"
                                          Margin="4"
                                          Command="{Binding DataContext.ToggleTagCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                          CommandParameter="{Binding}"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <TextBlock Grid.Row="10" Text="Custom Tag" Foreground="#BFBFBF" FontSize="12"/>
                <Grid Grid.Row="11" Margin="0,6,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0"
                             Height="28"
                             Text="{Binding CustomTagText, UpdateSourceTrigger=PropertyChanged}"
                             VerticalContentAlignment="Center"/>

                    <Button Grid.Column="2" Content="Add" Padding="14,6"
                            Command="{Binding AddCustomTagCommand}"/>
                    <Button Grid.Column="4" Content="Clear" Padding="14,6"
                            Command="{Binding ClearCustomTagCommand}"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>
